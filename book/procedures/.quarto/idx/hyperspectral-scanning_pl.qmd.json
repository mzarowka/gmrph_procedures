{"title":"Skanowanie hiperspektralne","markdown":{"yaml":{"editor":"visual","format":{"html":{"toc":true,"toc-title":"Etapy","toc-depth":4,"embed-resources":true},"pdf":{"geometry":["top=20mm","left=20mm","bottom=20mm","right=20mm"]}},"theme":{"light":"flatly","dark":"darkly"}},"headingText":"Skanowanie hiperspektralne","containsRefs":false,"markdown":"\n\n\n## Przygotowanie rdzeni\n\nWskazane jest skanowanie świeżych rdzeni, możliwie szybko po otwarciu ze względu na postępującą z czasem degradację pigmentów. Rdzenie muszą zostać oczyszczone i w miarę możliwości wyrównane. Należy usunąć wierzchnią warstwę osadu, starając się nie powodować powstawania linii po wyrównywaniu. Jest to szczególnie istotne w przypadku drobnej laminacji. W przypadku osadów przechowywanych przez dłuższy czas, należy zwrócić uwagę na usunięcie oznak utlenienia, wtórnej krystalizacji, biofilmów i tym podobnych.\n\nWoda i wilgoć na powierzchni rdzeni, oraz świeże, ciemne osady znacząco utrudniają analizę spektralną. Po oczyszczeniu rdzenie należy zabezpieczyć i pozostawić w ciemnym pomieszczeniu do czasu wyschnięcia powierzchni. Rdzenie można pozostawić w otwartych D-tubach. Na czas schnięcia rdzenie przechowywać w ciemnym miejscu w celu uniknięcia fotodegradacji pigmentów. Rdzeni nie należy pozostawiać do wyschnięcia na długo, ponieważ zaczną pękać. Drobnoziarniste osady mineralne zaczną pękać prędzej od biogenicznej gytii. W przypadku nowego materiału rdzenie należy obserwować w celu oceny optymalnego okresu wysychania. Przeważnie materiał można przygotować po południu i sprawdzić na drugi dzień rano.\n\nJeśli rdzeń jest wyrównany, ale jedna ze stron się zapada, można zastosować podkładkę w celu wyrównania poziomu rodzenia.\n\n## Przygotowanie do pracy\n\n### Wybór ustawień\n\n-   Wąskie rdzenie (**Φ 63 mm**): obiektywy **50.0 mm** oraz **18.5 mm**; razem z aluminiową szyną.\n\n-   Szerokie rdzenie (**Φ 90 mm**): obiektyw **18.5 mm**; bez aluminiowej szyny.\n\n    | Nie należy wykręcać obiektywu przy poluzowanej obręczy.\n    | Obręcz luzować tylko w czasie ustawiania ostrości.\n\n    | Zdjęcia obiektywów znajdują się w sekcji [Załącznik 1: obiektywy].\n\n### Przygotowanie stanowiska\n\n-   Włączyć zasilacz awaryjny UPS pod stołem.\n\n-   Włączyć komputer (przełączniki od dołu do góry).\n\n-   Włączyć iluminator (przełącznik z przodu urządzenia).\n\n-   Upewnić się, że włączony jest tryb **VNIR** (przełącznik z przodu urządzenia).\n\n-   Ostrożnie usunąć osłonę obiektywu.\n\n    | Upewnić się, że wybrany jest właściwy obiektyw ([Załącznik 1: obiektywy]).\n\n-   Ułożyć rdzeń na prowadnicy, stropem do góry.\n\n-   Ustawić stolik ze wzorcem bieli oraz **focus grid** na równi z powierzchnią rdzenia.\n\n-   Ustawić miarkę na równi z rdzeniem, możliwie równolegle.\n\n    | W miarę konieczności ułożyć miarę na rdzeniu, **równoległe** ułożenie miary jest **priorytetem**. Lepszy wynik osiągnie się przy minimalnie różnym poziomie między miarą a osadem, ale przy zachowaniu równoległego ułożenia. Wzrost **kąta** między osią miary i rdzenia skutkuje **zniekształceniem** na etapie przetwarzania danych. Określenie właściwej pozycji **stropu** i **spągu** na mierze jest czynnikiem **krytycznym**.\n\n-   Ostrożnie umieścić wzorzec bieli na stoliku (sztabka BaSO~4~); łapać tylko za boki i delikatnie usunąć kurz (na przykład chusteczkami do obiektywów).\n\n-   Jeśli poziom rdzeni jest do siebie **mocno** zbliżony, **nie należy** **korygować** ustawień kamery.\n\n-   Na stoliku, na części zajętej przez biały plastikowy blok umieścić papierową etykietę z symbolem rdzenia ([Załącznik 2: etykiety]).\n\n## Oprogramowanie Lumo Scanner\n\n### Zakładka Setup\n\n-   Pole `Camera`, wybrać odpowiednią kamerę -- `Connect`.\n\n    | W tej chwili jedyna dostępne urządzenie to kamera **VNIR**.\n\n-   Pole `calibration pack` wybrać odpowiedni plik kalibracyjny, zależny od obiektywu.\n\n    -   Obiektyw **18.5 mm**\n\n        *Specim\\\\Documents\\\\Calibration\\\\560025_20211124_OLE18.5_calpack.scp*\n\n    -   Obiektyw **50.0 mm**\n\n        *Specim\\\\Documents\\\\Calibration\\\\560025_20211124_OL50_calpack.scp*\n\n    | Zmiana obiektywu wymaga ponownego uruchomienia programu i połączenia z kamerą.\n\n-   Pole `Capture folder`: wybrać folder, w którym będą zapisywane dane.\n\n-   Pole `Dataset prefix`: wspólny przedrostek (*prefix*) zbioru danych (np. **GOR-20**).\n\n-   Podgląd rdzenia:\n\n    -   Red band: Band 207: 653.61 nm.\n\n    -   Green band: Band 127: 552.41 nm.\n\n    -   Blue band: Band 46: 452.7 nm.\n\n-   Pole `Motor 1`: połączyć program z napędem skanera -- `Connect`.\n\n### Zakładka Adjust\n\n-   Panel `Spectral Camera sCMOS` pole `Spectral binning`: **2**.\n\n    | W przypadku skanowania tylko w celu wykonania dokumentacji fotograficznej można zmienić wartość na wyższą.\n\n-   Panel `Spectral Camera sCMOS` pole `Spatial binning`: **1**.\n\n    | Ta wartość ma charakter stały, nie należy jej zmieniać.\n\n-   Ustawić kamerę na takiej wysokości, aby objęła cały rdzeń razem z miarą oraz niewielkim zapasem (**około 1 cm**) z obu stron. Rdzeń można przesuwać do przodu i do tyłu odpowiednimi przyciskami w polu `Motor`. Przy podglądzie należy upewnić się, że widać całość rejestrowanego przez kamerę obrazu.\n\n-   Po wybraniu odpowiedniej wysokości należy ustawić skaner na obszar **focus grid** w polu `Sensor 1` position -- `Go`.\n\n    #### Ekspozycja\n\n-   W panelu `Spectral Camera sCMOS` ustawić opcje ekspozycji.\n\n    | Celem jest zmaksymalizowanie jasności bez osiągnięcia nadmiernej ekspozycji (*overexposure*) widocznej jako czerwone piksele na podglądzie.\n\n-   W panelu `Detector` (lewy górny wykres) przesunąć **białą, pionową linię** na środek białego pola **focus grid** możliwie blisko środka pola `focus grid` (centralnie pod obiektywem).\n\n    | Wartości rejestrowane na linii widoczne są w panelu `Wavelenght` (dolny lewy wykres). Celem jest osiągnięcie maksymalnej wartości dla białej krzywej bez przekroczenia maksymalnych wartości na osi Y (pozostawić pewien zapas). Zwiększenie jasności polega na zwiększeniu wartości czasu ekspozycji (*exposure time*, ET). ET zmienia się odwrotnie do częstotliwości wyświetlania klatek (*frame rate*, FR).\n\n-   Metodą prób i błędów ustawić FR (frame rate), zastosować wartość -- `Apply`, ustawić maksymalną możliwą ekspozycję, zastosować wartość -- `Apply`. Sprawdzić wykres w panelu `Wavelenght` (lewy dolny wykres), w miarę konieczności skorygować, za każdym razem ustawiając wartość -- `Apply`.\n\n    | Każda zmiana wysokości stolika lub kamery (dystansu optycznego) wymaga korekty jasności i zastosowania nowych wartości.\n\n    #### Ostrość\n\n-   Po uzyskaniu właściwej jasności należy dokonać korekty ostrości w oparciu o wykresy: `Waterfall` (prawy górny wykres) oraz `Pixels` (prawy dolny wykres). Pomoc stanowi również prawy panel `Focusing`.\n\n-   Należy obracać obiektywem tak aby osiągnąć możliwe wyraźne białe i czarne pasy na wykresie `Waterfall` oraz możliwie spłaszczone piki, o wyraźnych krawędziach na wykresie `Pixels`.\n\n    | Wykres `Waterfall` można przybliżyć i oddalić menu prawego przycisku myszy, po odznaczeniu opcji `fit to window`. Ostre krawędzie na wykresie `Pixels` oznaczają wysoki kontrast między czarnymi i białymi pasami pola **focus grid**. Kolor paska w panelu `Focusing` należy traktować jako wskazówkę. Metodą prób i błędów, przez przekroczenie ostrości w obu kierunkach zawęzić pole wyostrzania w celu osiągnięcia możliwie ostrego obrazu. Dobry obraz jest wyraźny na wykresie `Waterfall`, „kanciasty\" na wykresie `Pixels` a panel `Focusing` pokazuje pomarańczowy lub zielony pasek. Pasek wyświetla się po kliknięciu `Run`.\n\n    #### Prędkość skanowania\n\n-   Prędkość skanowania należy ocenić na podstawie pola widzenia kamery (*field of view*, FOV).\n\n-   Najpierw w zakładce **Adjust** przesunąć zdecydowanie rdzeń przyciskami w panelu `Motor`, aby oszacować zakres pola widzenia.\n\n-   Przejść do zakładki **Capture**.\n\n-   Upewnić się, że widoczny jest cały obraz z kamery.\n\n    | Wykres można przybliżyć i oddalić menu prawego przycisku myszy, po odznaczeniu opcji `fit to window`.\n\n-   W panelu `Motor` przesuwać rdzeń do przodu, tak aby pojawiła się poprzeczna miara poprzedzająca strop.\n\n    | Przy przesuwaniu rdzenia obraz jest zniekształcony wzdłuż dłuższej osi, ze względu na stałą prędkość ruchu.\n\n-   Wykonać zrzut ekranu, wkleić na przykład do **MS Paint** i dokładnie odczytać wartość na miarce, wyrażoną w mm.\n\n    | Należy upewnić się, że wyświetlany obraz to cały obraz rejestrowany przez kamerę. Podgląd ma tendencję do przybliżania środka kadru.\n\n-   Wrócić do zakładki **Adjust**. W panelu `Scanning speed calculation` wybrać opcję **Field of view**. Wprowadzić odczytaną wartość FOV wyrażoną w **mm**.\n\n-   Alternatywnie można wykonać krótki skan i odczytać wartość z wygenerowanego pliku.\n\n    #### Długość skanowania\n\n-   Panel `Sensor 1 positions`.\n\n    -   Pole `Target start`: **180 mm**, tak aby widoczna była etykieta (oryginalnie **250 mm**).\n\n        | Wartość stała.\n\n    -   Pole `Target stop`: **długość rdzenia (mm) + 300 mm**.\n\n### Zakładka Capture\n\n-   Upewnić się, czy na dysku jest wolne miejsce.\n\n    W dolnej części okna widoczne jest **Free disk space**. Musi mieć wartość minimum **10 minut**.\n\n-   Sprawdzić `Traffic lights`.\n\n    Wszystko powinno być zielone poza **Trigger mode**, które pokazuje się na czerwonym tle jako **internal**. **Sensor temp** (Temperatura kamery), może być wyświetlona na pomarańczowym tle, ale nie należy zostawiać urządzenia włączonego bezczynnie, tak aby się nie przegrzało.\n\n-   Uzupełnić dane w panelu `Metadata`:\n\n    -   Pole `Dataset name`: kod rdzenia\n\n        Jeśli **Dataset prefix** to **GOR-20**, wtedy **Dataset name** to np. **01** dla rdzenia **GOR-20/01**.\n\n    -   Jeśli rdzeń wykracza poza miarę, należy zeskanować go dwukrotnie, od stropu i od spągu.\n\n        W takim przypadku do **Dataset name** dodać podkreślenie i przyrostek (*sufix*) **front** lub **rear** (np. **01_front**). W ten sposób skanowanie od strony stropu jest zawsze sortowane leksykalnie przed skanowaniem od strony spągu.\n\n    -   Właściwy **Dataset name** powinien mieć następującą formę:\n\n        -   01: skanowanie całego rdzenia.\n        -   01_front: skanowanie rdzenia od stropu.\n        -   01_rear: skanowanie rdzenia od spągu.\n\n-   Pole `Operator`: inicjały osoby wykonującej skanowanie.\n\n-   Wyłączyć monitor, zgasić światła w pomieszczeniu, zamknąć drzwi i wywiesić kartkę informującą o skanowaniu.\n\n-   Połączyć się z komputerem korzystając ze zdalnego pulpitu.\n\n    | Odpowiedni plik `*.vnc` znajduje się na serwerze:\n    | *Public\\\\Sprzęt i programy\\\\Network\\\\B106_HSI.vnc*\n\n    | **TightVNC**: https://www.tightvnc.com/download.php\n    | **RealVNC**: https://www.realvnc.com/en/connect/download/viewer/\n\n-   Rozpocząć skanowanie guzikiem `Record`.\n\n## Zakończenie pracy\n\nJeśli nie została przekroczona pojemność dysku skanowanie powinno zakończyć się bez błędów.\n\n-   Poczekać aż szyna wraz ze rdzeniem wróci na pozycję początkową (komunikat *Homing*).\n\n    | Nigdy nie przesuwać szyny ręcznie przy włączonym silniku.\n\n-   Wyłączyć kamerę i iluminator z przodu urządzenia.\n\n-   W zakładce **Setup** użyć przycisków `Disconnect` w polach `Camera` oraz `Motor 1`.\n\n-   Zamknąć oprogramowanie **Lumo Scanner**.\n\n-   Przenieść zgromadzone dane na serwer Zakładu.\n\n    | Ze względu na duży rozmiar danych można pozostawić proces na noc.\n\n-   Zamknąć system Windows (`Windows` -- `Shut down`).\n\n-   Po zamknięciu systemu wyłączyć zasilanie w kolejności od góry do dołu.\n\n-   Wyłączyć zasilacz awaryjny UPS.\n\n-   Schować wzorzec bieli, chwytając tylko za boki.\n\n-   Ostrożnie założyć osłonę obiektywu.\n\n-   Wyczyścić miejsce pracy.\n\n{{< pagebreak >}}\n\n## Załącznik 1: obiektywy\n\n![Obiektyw 18.5 mm](images/specim-18.5.png){alt=\"Obiektyw 18.5 mm\" width=\"187\"}\n\n![Obiektyw 50.0 mm](images/specim-50.0.png){alt=\"Obiektyw 50.0 mm\" width=\"187\"}\n\n{{< pagebreak >}}\n\n## Załącznik 2: etykiety\n\n![Wzór etykiet jednorazowych (źródło: Butz 2016)](images/hsi_labels.jpg){fig-align=\"center\" width=\"50%\"}\n\n{{< pagebreak >}}\n\n## Rejestr zmian\n\n-   16.11.2022, MZ: wersja inicjalna.\n-   17.11.2022, MZ: pierwsze poprawki.\n-   30.11.2022, MZ: kolejne poprawki. Pierwsza wersja Quarto.\n-   09.12.2022, MZ: poprawki, dodano info i wzór etykiet.\n-   14.12.2022, MZ: poprawki, dodano informacje i fotografie obiektywów.\n\nMaurycy Żarczyński\n","srcMarkdownNoYaml":"\n\n# Skanowanie hiperspektralne\n\n## Przygotowanie rdzeni\n\nWskazane jest skanowanie świeżych rdzeni, możliwie szybko po otwarciu ze względu na postępującą z czasem degradację pigmentów. Rdzenie muszą zostać oczyszczone i w miarę możliwości wyrównane. Należy usunąć wierzchnią warstwę osadu, starając się nie powodować powstawania linii po wyrównywaniu. Jest to szczególnie istotne w przypadku drobnej laminacji. W przypadku osadów przechowywanych przez dłuższy czas, należy zwrócić uwagę na usunięcie oznak utlenienia, wtórnej krystalizacji, biofilmów i tym podobnych.\n\nWoda i wilgoć na powierzchni rdzeni, oraz świeże, ciemne osady znacząco utrudniają analizę spektralną. Po oczyszczeniu rdzenie należy zabezpieczyć i pozostawić w ciemnym pomieszczeniu do czasu wyschnięcia powierzchni. Rdzenie można pozostawić w otwartych D-tubach. Na czas schnięcia rdzenie przechowywać w ciemnym miejscu w celu uniknięcia fotodegradacji pigmentów. Rdzeni nie należy pozostawiać do wyschnięcia na długo, ponieważ zaczną pękać. Drobnoziarniste osady mineralne zaczną pękać prędzej od biogenicznej gytii. W przypadku nowego materiału rdzenie należy obserwować w celu oceny optymalnego okresu wysychania. Przeważnie materiał można przygotować po południu i sprawdzić na drugi dzień rano.\n\nJeśli rdzeń jest wyrównany, ale jedna ze stron się zapada, można zastosować podkładkę w celu wyrównania poziomu rodzenia.\n\n## Przygotowanie do pracy\n\n### Wybór ustawień\n\n-   Wąskie rdzenie (**Φ 63 mm**): obiektywy **50.0 mm** oraz **18.5 mm**; razem z aluminiową szyną.\n\n-   Szerokie rdzenie (**Φ 90 mm**): obiektyw **18.5 mm**; bez aluminiowej szyny.\n\n    | Nie należy wykręcać obiektywu przy poluzowanej obręczy.\n    | Obręcz luzować tylko w czasie ustawiania ostrości.\n\n    | Zdjęcia obiektywów znajdują się w sekcji [Załącznik 1: obiektywy].\n\n### Przygotowanie stanowiska\n\n-   Włączyć zasilacz awaryjny UPS pod stołem.\n\n-   Włączyć komputer (przełączniki od dołu do góry).\n\n-   Włączyć iluminator (przełącznik z przodu urządzenia).\n\n-   Upewnić się, że włączony jest tryb **VNIR** (przełącznik z przodu urządzenia).\n\n-   Ostrożnie usunąć osłonę obiektywu.\n\n    | Upewnić się, że wybrany jest właściwy obiektyw ([Załącznik 1: obiektywy]).\n\n-   Ułożyć rdzeń na prowadnicy, stropem do góry.\n\n-   Ustawić stolik ze wzorcem bieli oraz **focus grid** na równi z powierzchnią rdzenia.\n\n-   Ustawić miarkę na równi z rdzeniem, możliwie równolegle.\n\n    | W miarę konieczności ułożyć miarę na rdzeniu, **równoległe** ułożenie miary jest **priorytetem**. Lepszy wynik osiągnie się przy minimalnie różnym poziomie między miarą a osadem, ale przy zachowaniu równoległego ułożenia. Wzrost **kąta** między osią miary i rdzenia skutkuje **zniekształceniem** na etapie przetwarzania danych. Określenie właściwej pozycji **stropu** i **spągu** na mierze jest czynnikiem **krytycznym**.\n\n-   Ostrożnie umieścić wzorzec bieli na stoliku (sztabka BaSO~4~); łapać tylko za boki i delikatnie usunąć kurz (na przykład chusteczkami do obiektywów).\n\n-   Jeśli poziom rdzeni jest do siebie **mocno** zbliżony, **nie należy** **korygować** ustawień kamery.\n\n-   Na stoliku, na części zajętej przez biały plastikowy blok umieścić papierową etykietę z symbolem rdzenia ([Załącznik 2: etykiety]).\n\n## Oprogramowanie Lumo Scanner\n\n### Zakładka Setup\n\n-   Pole `Camera`, wybrać odpowiednią kamerę -- `Connect`.\n\n    | W tej chwili jedyna dostępne urządzenie to kamera **VNIR**.\n\n-   Pole `calibration pack` wybrać odpowiedni plik kalibracyjny, zależny od obiektywu.\n\n    -   Obiektyw **18.5 mm**\n\n        *Specim\\\\Documents\\\\Calibration\\\\560025_20211124_OLE18.5_calpack.scp*\n\n    -   Obiektyw **50.0 mm**\n\n        *Specim\\\\Documents\\\\Calibration\\\\560025_20211124_OL50_calpack.scp*\n\n    | Zmiana obiektywu wymaga ponownego uruchomienia programu i połączenia z kamerą.\n\n-   Pole `Capture folder`: wybrać folder, w którym będą zapisywane dane.\n\n-   Pole `Dataset prefix`: wspólny przedrostek (*prefix*) zbioru danych (np. **GOR-20**).\n\n-   Podgląd rdzenia:\n\n    -   Red band: Band 207: 653.61 nm.\n\n    -   Green band: Band 127: 552.41 nm.\n\n    -   Blue band: Band 46: 452.7 nm.\n\n-   Pole `Motor 1`: połączyć program z napędem skanera -- `Connect`.\n\n### Zakładka Adjust\n\n-   Panel `Spectral Camera sCMOS` pole `Spectral binning`: **2**.\n\n    | W przypadku skanowania tylko w celu wykonania dokumentacji fotograficznej można zmienić wartość na wyższą.\n\n-   Panel `Spectral Camera sCMOS` pole `Spatial binning`: **1**.\n\n    | Ta wartość ma charakter stały, nie należy jej zmieniać.\n\n-   Ustawić kamerę na takiej wysokości, aby objęła cały rdzeń razem z miarą oraz niewielkim zapasem (**około 1 cm**) z obu stron. Rdzeń można przesuwać do przodu i do tyłu odpowiednimi przyciskami w polu `Motor`. Przy podglądzie należy upewnić się, że widać całość rejestrowanego przez kamerę obrazu.\n\n-   Po wybraniu odpowiedniej wysokości należy ustawić skaner na obszar **focus grid** w polu `Sensor 1` position -- `Go`.\n\n    #### Ekspozycja\n\n-   W panelu `Spectral Camera sCMOS` ustawić opcje ekspozycji.\n\n    | Celem jest zmaksymalizowanie jasności bez osiągnięcia nadmiernej ekspozycji (*overexposure*) widocznej jako czerwone piksele na podglądzie.\n\n-   W panelu `Detector` (lewy górny wykres) przesunąć **białą, pionową linię** na środek białego pola **focus grid** możliwie blisko środka pola `focus grid` (centralnie pod obiektywem).\n\n    | Wartości rejestrowane na linii widoczne są w panelu `Wavelenght` (dolny lewy wykres). Celem jest osiągnięcie maksymalnej wartości dla białej krzywej bez przekroczenia maksymalnych wartości na osi Y (pozostawić pewien zapas). Zwiększenie jasności polega na zwiększeniu wartości czasu ekspozycji (*exposure time*, ET). ET zmienia się odwrotnie do częstotliwości wyświetlania klatek (*frame rate*, FR).\n\n-   Metodą prób i błędów ustawić FR (frame rate), zastosować wartość -- `Apply`, ustawić maksymalną możliwą ekspozycję, zastosować wartość -- `Apply`. Sprawdzić wykres w panelu `Wavelenght` (lewy dolny wykres), w miarę konieczności skorygować, za każdym razem ustawiając wartość -- `Apply`.\n\n    | Każda zmiana wysokości stolika lub kamery (dystansu optycznego) wymaga korekty jasności i zastosowania nowych wartości.\n\n    #### Ostrość\n\n-   Po uzyskaniu właściwej jasności należy dokonać korekty ostrości w oparciu o wykresy: `Waterfall` (prawy górny wykres) oraz `Pixels` (prawy dolny wykres). Pomoc stanowi również prawy panel `Focusing`.\n\n-   Należy obracać obiektywem tak aby osiągnąć możliwe wyraźne białe i czarne pasy na wykresie `Waterfall` oraz możliwie spłaszczone piki, o wyraźnych krawędziach na wykresie `Pixels`.\n\n    | Wykres `Waterfall` można przybliżyć i oddalić menu prawego przycisku myszy, po odznaczeniu opcji `fit to window`. Ostre krawędzie na wykresie `Pixels` oznaczają wysoki kontrast między czarnymi i białymi pasami pola **focus grid**. Kolor paska w panelu `Focusing` należy traktować jako wskazówkę. Metodą prób i błędów, przez przekroczenie ostrości w obu kierunkach zawęzić pole wyostrzania w celu osiągnięcia możliwie ostrego obrazu. Dobry obraz jest wyraźny na wykresie `Waterfall`, „kanciasty\" na wykresie `Pixels` a panel `Focusing` pokazuje pomarańczowy lub zielony pasek. Pasek wyświetla się po kliknięciu `Run`.\n\n    #### Prędkość skanowania\n\n-   Prędkość skanowania należy ocenić na podstawie pola widzenia kamery (*field of view*, FOV).\n\n-   Najpierw w zakładce **Adjust** przesunąć zdecydowanie rdzeń przyciskami w panelu `Motor`, aby oszacować zakres pola widzenia.\n\n-   Przejść do zakładki **Capture**.\n\n-   Upewnić się, że widoczny jest cały obraz z kamery.\n\n    | Wykres można przybliżyć i oddalić menu prawego przycisku myszy, po odznaczeniu opcji `fit to window`.\n\n-   W panelu `Motor` przesuwać rdzeń do przodu, tak aby pojawiła się poprzeczna miara poprzedzająca strop.\n\n    | Przy przesuwaniu rdzenia obraz jest zniekształcony wzdłuż dłuższej osi, ze względu na stałą prędkość ruchu.\n\n-   Wykonać zrzut ekranu, wkleić na przykład do **MS Paint** i dokładnie odczytać wartość na miarce, wyrażoną w mm.\n\n    | Należy upewnić się, że wyświetlany obraz to cały obraz rejestrowany przez kamerę. Podgląd ma tendencję do przybliżania środka kadru.\n\n-   Wrócić do zakładki **Adjust**. W panelu `Scanning speed calculation` wybrać opcję **Field of view**. Wprowadzić odczytaną wartość FOV wyrażoną w **mm**.\n\n-   Alternatywnie można wykonać krótki skan i odczytać wartość z wygenerowanego pliku.\n\n    #### Długość skanowania\n\n-   Panel `Sensor 1 positions`.\n\n    -   Pole `Target start`: **180 mm**, tak aby widoczna była etykieta (oryginalnie **250 mm**).\n\n        | Wartość stała.\n\n    -   Pole `Target stop`: **długość rdzenia (mm) + 300 mm**.\n\n### Zakładka Capture\n\n-   Upewnić się, czy na dysku jest wolne miejsce.\n\n    W dolnej części okna widoczne jest **Free disk space**. Musi mieć wartość minimum **10 minut**.\n\n-   Sprawdzić `Traffic lights`.\n\n    Wszystko powinno być zielone poza **Trigger mode**, które pokazuje się na czerwonym tle jako **internal**. **Sensor temp** (Temperatura kamery), może być wyświetlona na pomarańczowym tle, ale nie należy zostawiać urządzenia włączonego bezczynnie, tak aby się nie przegrzało.\n\n-   Uzupełnić dane w panelu `Metadata`:\n\n    -   Pole `Dataset name`: kod rdzenia\n\n        Jeśli **Dataset prefix** to **GOR-20**, wtedy **Dataset name** to np. **01** dla rdzenia **GOR-20/01**.\n\n    -   Jeśli rdzeń wykracza poza miarę, należy zeskanować go dwukrotnie, od stropu i od spągu.\n\n        W takim przypadku do **Dataset name** dodać podkreślenie i przyrostek (*sufix*) **front** lub **rear** (np. **01_front**). W ten sposób skanowanie od strony stropu jest zawsze sortowane leksykalnie przed skanowaniem od strony spągu.\n\n    -   Właściwy **Dataset name** powinien mieć następującą formę:\n\n        -   01: skanowanie całego rdzenia.\n        -   01_front: skanowanie rdzenia od stropu.\n        -   01_rear: skanowanie rdzenia od spągu.\n\n-   Pole `Operator`: inicjały osoby wykonującej skanowanie.\n\n-   Wyłączyć monitor, zgasić światła w pomieszczeniu, zamknąć drzwi i wywiesić kartkę informującą o skanowaniu.\n\n-   Połączyć się z komputerem korzystając ze zdalnego pulpitu.\n\n    | Odpowiedni plik `*.vnc` znajduje się na serwerze:\n    | *Public\\\\Sprzęt i programy\\\\Network\\\\B106_HSI.vnc*\n\n    | **TightVNC**: https://www.tightvnc.com/download.php\n    | **RealVNC**: https://www.realvnc.com/en/connect/download/viewer/\n\n-   Rozpocząć skanowanie guzikiem `Record`.\n\n## Zakończenie pracy\n\nJeśli nie została przekroczona pojemność dysku skanowanie powinno zakończyć się bez błędów.\n\n-   Poczekać aż szyna wraz ze rdzeniem wróci na pozycję początkową (komunikat *Homing*).\n\n    | Nigdy nie przesuwać szyny ręcznie przy włączonym silniku.\n\n-   Wyłączyć kamerę i iluminator z przodu urządzenia.\n\n-   W zakładce **Setup** użyć przycisków `Disconnect` w polach `Camera` oraz `Motor 1`.\n\n-   Zamknąć oprogramowanie **Lumo Scanner**.\n\n-   Przenieść zgromadzone dane na serwer Zakładu.\n\n    | Ze względu na duży rozmiar danych można pozostawić proces na noc.\n\n-   Zamknąć system Windows (`Windows` -- `Shut down`).\n\n-   Po zamknięciu systemu wyłączyć zasilanie w kolejności od góry do dołu.\n\n-   Wyłączyć zasilacz awaryjny UPS.\n\n-   Schować wzorzec bieli, chwytając tylko za boki.\n\n-   Ostrożnie założyć osłonę obiektywu.\n\n-   Wyczyścić miejsce pracy.\n\n{{< pagebreak >}}\n\n## Załącznik 1: obiektywy\n\n![Obiektyw 18.5 mm](images/specim-18.5.png){alt=\"Obiektyw 18.5 mm\" width=\"187\"}\n\n![Obiektyw 50.0 mm](images/specim-50.0.png){alt=\"Obiektyw 50.0 mm\" width=\"187\"}\n\n{{< pagebreak >}}\n\n## Załącznik 2: etykiety\n\n![Wzór etykiet jednorazowych (źródło: Butz 2016)](images/hsi_labels.jpg){fig-align=\"center\" width=\"50%\"}\n\n{{< pagebreak >}}\n\n## Rejestr zmian\n\n-   16.11.2022, MZ: wersja inicjalna.\n-   17.11.2022, MZ: pierwsze poprawki.\n-   30.11.2022, MZ: kolejne poprawki. Pierwsza wersja Quarto.\n-   09.12.2022, MZ: poprawki, dodano info i wzór etykiet.\n-   14.12.2022, MZ: poprawki, dodano informacje i fotografie obiektywów.\n\nMaurycy Żarczyński\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":4,"embed-resources":true,"output-file":"hyperspectral-scanning_pl.html"},"language":{"toc-title-document":"Spis treści","toc-title-website":"Na tej stronie","related-formats-title":"Inne formaty","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Źródło","section-title-abstract":"Abstrakt","section-title-appendices":"Załączniki","section-title-footnotes":"Przypisy","section-title-references":"Bibliografia","section-title-reuse":"Licencja","section-title-copyright":"Prawa autorskie","section-title-citation":"Cytowanie","appendix-attribution-cite-as":"W celu atrybucji, proszę cytować tę pracę jako:","appendix-attribution-bibtex":"cytowanie BibTeX:","title-block-author-single":"Autor","title-block-author-plural":"Autorzy","title-block-affiliation-single":"Afiliacja","title-block-affiliation-plural":"Afiliacje","title-block-published":"Opublikowano","title-block-modified":"Zmodyfikowano","callout-tip-title":"Wskazówka","callout-note-title":"Adnotacja","callout-warning-title":"Ostrzeżenie","callout-important-title":"Ważne","callout-caution-title":"Zagrożenie","code-summary":"Kod","code-tools-menu-caption":"Kod","code-tools-show-all-code":"Pokaż cały kod","code-tools-hide-all-code":"Ukryj cały kod","code-tools-view-source":"Pokaż źródło","code-tools-source-code":"Kod źródłowy","code-line":"Linia","code-lines":"Linie","copy-button-tooltip":"Kopiuj do schowka","copy-button-tooltip-success":"Skopiowano!","repo-action-links-edit":"Edytuj tę stronę","repo-action-links-source":"Pokaż źródło","repo-action-links-issue":"Zgłoś problem","back-to-top":"Powrót do góry","search-no-results-text":"Brak wyników","search-matching-documents-text":"dopasowane dokumenty","search-copy-link-title":"Kopiuj link do wyszukiwania","search-hide-matches-text":"Ukryj dodatkowe dopasowania","search-more-match-text":"więcej dopasowań w tym dokumencie","search-more-matches-text":"więcej dopasowań w tym dokumencie","search-clear-button-title":"Wyczyść","search-detached-cancel-button-title":"Anuluj","search-submit-button-title":"Zatwierdź","search":"Szukaj","toggle-section":"Przełącz sekcję","toggle-sidebar":"Przełącz pasek boczny","toggle-dark-mode":"Przełącz tryb ciemny","toggle-reader-mode":"Przełącz tryb czytnika","toggle-navigation":"Przełącz nawigację","crossref-fig-title":"Rysunek","crossref-tbl-title":"Tabela","crossref-lst-title":"Wykaz","crossref-thm-title":"Twierdzenie","crossref-lem-title":"Lemat","crossref-cor-title":"Wniosek","crossref-prp-title":"Proposition","crossref-cnj-title":"Przypuszczenie","crossref-def-title":"Definicja","crossref-exm-title":"Przykład","crossref-exr-title":"Ćwiczenie","crossref-ch-prefix":"Rozdział","crossref-apx-prefix":"Załącznik","crossref-sec-prefix":"Sekcja","crossref-eq-prefix":"Równanie","crossref-lof-title":"Spis rycin","crossref-lot-title":"Spis tabel","crossref-lol-title":"Spis wykazów","environment-proof-title":"Dowód","environment-remark-title":"Komentarz","environment-solution-title":"Rozwiązanie","listing-page-order-by":"Sortuj według","listing-page-order-by-default":"Domyślnie","listing-page-order-by-date-asc":"Od najstarszych","listing-page-order-by-date-desc":"Od najnowszych","listing-page-order-by-number-desc":"Od największych","listing-page-order-by-number-asc":"Od najmniejszych","listing-page-field-date":"Data","listing-page-field-title":"Tytuł","listing-page-field-description":"Opis","listing-page-field-author":"Autor","listing-page-field-filename":"Nazwa pliku","listing-page-field-filemodified":"Zmodyfikowano","listing-page-field-subtitle":"Podtytuł","listing-page-field-readingtime":"Czas czytania","listing-page-field-categories":"Kategorie","listing-page-minutes-compact":"{0} min","listing-page-category-all":"Wszystkie","listing-page-no-matches":"Brak pasujących"},"metadata":{"lang":"pl","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"editor":"visual","theme":"cosmo","toc-title":"Etapy"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"hyperspectral-scanning_pl.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt","theme":{"light":"flatly","dark":"darkly"},"geometry":["top=20mm","left=20mm","bottom=20mm","right=20mm"]},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}